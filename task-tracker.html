<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Tracker | OpenClaw</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">ğŸ§­ OpenClaw Control</div>
      <nav>
        <a href="./index.html">Home</a>
        <a href="./about.html">About</a>
        <a href="./task-tracker.html" class="active">Task Tracker</a>
        <a href="./calendar.html">Calendar</a>
        <a href="./documents.html">Documents</a>
      </nav>
    </header>

    <main class="container grid">
      <section class="card wide">
        <h1>Task Tracker</h1>
        <p class="muted">ì—ì´ì „íŠ¸ ìˆ˜í–‰ ì‘ì—… ì´ë ¥ ì¶”ì  (ìë™ ë¡œê·¸ + ìˆ˜ë™ ë©”ëª¨)</p>
        <div id="summary" class="hash-summary">ë¡œë”© ì¤‘...</div>
        <div class="table-wrap">
          <table class="hash-table" id="taskTable">
            <thead><tr><th>ì‹œê°„</th><th>ìœ í˜•</th><th>ì‘ì—…</th><th>ìƒíƒœ</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="card wide">
        <h2>ìˆ˜ë™ ë¡œê·¸ ì¶”ê°€</h2>
        <div class="form-row"><input id="taskText" placeholder="ì˜ˆ: ëœë”© ë¬¸êµ¬ ìˆ˜ì • ìš”ì²­ ë°˜ì˜" /></div>
        <div class="form-row">
          <select id="taskType"><option>ops</option><option>content</option><option>dev</option><option>deploy</option></select>
          <select id="taskStatus"><option>done</option><option>in-progress</option><option>blocked</option></select>
          <button class="btn" id="addBtn">ì¶”ê°€</button>
        </div>
      </section>
    </main>

    <script>
      const LS_KEY = 'openclaw_manual_tasks_v1';
      function fmt(t){return new Date(t).toLocaleString('ko-KR');}
      async function load(){
        const res = await fetch('./data/task-log.json?_=' + Date.now());
        const data = await res.json();
        const manual = JSON.parse(localStorage.getItem(LS_KEY)||'[]');
        const all=[...manual, ...data.tasks].sort((a,b)=> new Date(b.time)-new Date(a.time));
        document.getElementById('summary').innerHTML = `ì´ <strong>${all.length}</strong>ê°œ ì‘ì—… Â· ìë™ ${data.tasks.length} / ìˆ˜ë™ ${manual.length}`;
        document.querySelector('#taskTable tbody').innerHTML = all.map(t=>`<tr><td>${fmt(t.time)}</td><td>${t.type}</td><td>${t.title}</td><td>${t.status}</td></tr>`).join('');
      }
      document.getElementById('addBtn').addEventListener('click', ()=>{
        const title=document.getElementById('taskText').value.trim();
        if(!title) return;
        const list=JSON.parse(localStorage.getItem(LS_KEY)||'[]');
        list.push({time:new Date().toISOString(), type:document.getElementById('taskType').value, title, status:document.getElementById('taskStatus').value});
        localStorage.setItem(LS_KEY, JSON.stringify(list));
        document.getElementById('taskText').value='';
        load();
      });
      load();
    </script>
  </body>
</html>
